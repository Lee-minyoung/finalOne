import{_,c as u,a as l,w as a,b as v,v as p,F as g,r as b,g as h,o as m,t as c,i as S,j as y,d as w,l as x,e as f}from"./index-CxFk6QSJ.js";const D={props:{ordList:{type:Array,default:()=>[]}},data(){const n=new Date,t=n.getFullYear(),s=String(n.getMonth()+1).padStart(2,"0"),d=String(n.getDate()).padStart(2,"0"),o=`${t}-${s}-${d}`;return{search:"",spmDateStart:o,spmDateEnd:o}},computed:{filteredOrds(){return this.ordList?this.ordList.filter(n=>{const t=!this.search||n.cpy_nm&&n.cpy_nm.includes(this.search);let s="";if(n.spm_dt){const r=new Date(n.spm_dt);s=new Date(r.getTime()+9*60*60*1e3).toISOString().slice(0,10)}const d=this.spmDateStart,o=this.spmDateEnd;let i=!0;return d&&s&&s<d&&(i=!1),o&&s&&s>o&&(i=!1),t&&i}):[]}},methods:{selectOrd(n){this.$emit("select-mat",n),this.$emit("close")},formatDate(n){if(!n)return"";const t=new Date(n),s=t.getFullYear(),d=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${s}-${d}-${o}`}}},M={class:"modal-dialog modal-lg"},I={class:"modal-content"},O={class:"modal-header"},k={class:"modal-body"},L={class:"mb-2"},V={class:"table table-sm table-bordered text-center"},F=["onClick"];function U(n,t,s,d,o,i){return m(),u("div",{class:"modal fade show d-block",style:{background:"rgba(0,0,0,0.5)","z-index":"1051"},onClick:t[4]||(t[4]=h(r=>n.$emit("close"),["self"]))},[l("div",M,[l("div",I,[l("div",O,[t[5]||(t[5]=l("h5",{class:"modal-title"},"수주 선택",-1)),l("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=r=>n.$emit("close"))})]),l("div",k,[l("div",L,[a(l("input",{type:"text",class:"form-control w-25",placeholder:"납품업체 검색","onUpdate:modelValue":t[1]||(t[1]=r=>o.search=r)},null,512),[[p,o.search]]),t[6]||(t[6]=l("label",{class:"form-label",style:{"margin-left":"70px","margin-right":"10px"}},"출하일자",-1)),a(l("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>o.spmDateStart=r),type:"date",class:"form-control"},null,512),[[p,o.spmDateStart]]),t[7]||(t[7]=v(" ~ ")),a(l("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>o.spmDateEnd=r),type:"date",class:"form-control"},null,512),[[p,o.spmDateEnd]])]),l("table",V,[t[8]||(t[8]=l("thead",{class:"table-light"},[l("tr",null,[l("th",null,"수주번호"),l("th",null,"납품처"),l("th",null,"출하일자")])],-1)),l("tbody",null,[(m(!0),u(g,null,b(i.filteredOrds,r=>(m(),u("tr",{key:r.ord_no,onClick:e=>i.selectOrd(r),style:{cursor:"pointer"}},[l("td",null,c(r.ord_no),1),l("td",null,c(r.cpy_nm),1),l("td",null,c(i.formatDate(r.spm_dt)),1)],8,F))),128))])])])])])])}const C=_(D,[["render",U]]),N={components:{OrdSelModal:C},data(){return{showOrdModal:!1,ordList:[],productList:[],searchQuery:"",selectedMatNo:"",selectedMatNm:"",detailInfo:{cpy_nm:"",ceo_nm:"",mgr_ctt:"",mgr:"",ofc_addr:"",spm_dt:""}}},methods:{openOrdModal(){f.get("/api/spmFns/complete/product").then(n=>{this.ordList=Array.isArray(n.data)?n.data:[],this.showOrdModal=!0}).catch(n=>{console.error("수주 목록 불러오기 실패",n),this.ordList=[]})},async handleSelectedOrd(n){try{const t=await f.get("/api/spmFns/complete/product/detail",{params:{ord_no:n.ord_no}});if(t.data&&t.data.length>0){const d=t.data[0];this.detailInfo={cpy_nm:d.cpy_nm||"",ceo_nm:d.ceo_nm||"",mgr_ctt:d.mgr_ctt||"",mgr:d.mgr||"",ofc_addr:d.ofc_addr||"",spm_dt:d.spm_dt||""}}else this.detailInfo={cpy_nm:"",ceo_nm:"",mgr_ctt:"",mgr:"",ofc_addr:"",spm_dt:""};const s=await f.get("/api/spmFns/complete/product/detail/product",{params:{ord_no:n.ord_no}});this.productList=Array.isArray(s.data)?s.data:[],this.searchQuery=n.ord_no}catch{alert("상세정보 조회 실패"),this.detailInfo={cpy_nm:"",ceo_nm:"",mgr_ctt:"",mgr:"",ofc_addr:"",spm_dt:""},this.productList=[]}this.showOrdModal=!1},async fetchDetail(n){try{const t=await f.get("/api/spmFns/complete/product/detail",{params:{ord_no:n.ord_no}});if(t.data&&t.data.length>0){const s=t.data[0];this.detailInfo={cpy_nm:s.cpy_nm||"",ceo_nm:s.ceo_nm||"",mgr_ctt:s.mgr_ctt||"",mgr:s.mgr||"",ofc_addr:s.ofc_addr||"",spm_dt:s.spm_dt||""}}else this.detailInfo={cpy_nm:"",ceo_nm:"",mgr_ctt:"",mgr:"",ofc_addr:"",spm_dt:""}}catch{alert("상세정보 조회 실패"),this.detailInfo={cpy_nm:"",ceo_nm:"",mgr_ctt:"",mgr:"",ofc_addr:"",spm_dt:""}}},formatDateTime(n){if(!n)return"";const t=new Date(n),s=t.getFullYear(),d=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${s}-${d}-${o}`}}},A={class:"input"},E={class:"info-box"},T={style:{"margin-left":"50px","margin-right":"50px","padding-bottom":"10px","padding-top":"10px"}},B={class:"info-row"},Q={class:"info-col"},j={class:"info-row"},Y={class:"info-col info"},$={class:"info-row"},q={class:"info-col"},z={class:"info-row"},G={class:"info-col"},H={class:"info-row"},J={class:"info-col"},K={class:"info-col info-center",style:{"margin-left":"11px"}},P=["value"],R={class:"table table-bordered text-center",style:{"margin-top":"5px"}},W={key:0};function X(n,t,s,d,o,i){const r=x("OrdSelModal");return m(),u(g,null,[t[23]||(t[23]=l("div",{class:"container mt-4"},[l("div",{class:"d-flex justify-content-between align-items-center mb-4"},[l("div",{class:"d-flex gap-4"},[l("h2",{class:"mb-4"},"출고조회")])])],-1)),l("div",A,[t[8]||(t[8]=v(" 수주번호 ")),a(l("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.searchQuery=e),class:"form-control",id:"input_id",placeholder:"",readonly:""},null,512),[[p,o.searchQuery]]),l("button",{class:"btn btn-outline-secondary",id:"icon-btn",onClick:t[1]||(t[1]=(...e)=>i.openOrdModal&&i.openOrdModal(...e)),style:{"margin-right":"100px"}},"🔍")]),t[24]||(t[24]=l("br",null,null,-1)),l("div",E,[l("div",T,[t[20]||(t[20]=w('<div class="info-row"><div class="info-col" style="margin-left:190px;"><div class="info-title">납품처 정보</div></div><div class="info-col info-right" style="margin-right:15px;margin-top:-3px;"><div class="info-title">공급처 정보</div></div></div>',1)),l("div",B,[l("div",Q,[t[9]||(t[9]=l("label",null,"상호명",-1)),a(l("input",{class:"info-input","onUpdate:modelValue":t[2]||(t[2]=e=>o.detailInfo.cpy_nm=e),readonly:""},null,512),[[p,o.detailInfo.cpy_nm]])]),t[10]||(t[10]=l("div",{class:"info-col info-right"},[l("label",null,"상호명"),l("input",{class:"info-input",value:"(주)밥먹고하시조",readonly:""})],-1))]),l("div",j,[l("div",Y,[t[11]||(t[11]=l("label",null,"대표",-1)),a(l("input",{class:"info-input","onUpdate:modelValue":t[3]||(t[3]=e=>o.detailInfo.ceo_nm=e),readonly:""},null,512),[[p,o.detailInfo.ceo_nm]])]),t[12]||(t[12]=l("div",{class:"info-col info-right"},[l("label",null,"전화"),l("input",{class:"info-input",value:"053-421-2460",readonly:""})],-1))]),l("div",$,[l("div",q,[t[13]||(t[13]=l("label",null,"전화",-1)),a(l("input",{class:"info-input","onUpdate:modelValue":t[4]||(t[4]=e=>o.detailInfo.mgr_ctt=e),readonly:""},null,512),[[p,o.detailInfo.mgr_ctt]])]),t[14]||(t[14]=l("div",{class:"info-col info-right"},[l("label",null,"대표"),l("input",{class:"info-input",value:"서강중",readonly:""})],-1))]),l("div",z,[l("div",G,[t[15]||(t[15]=l("label",null,"담당자",-1)),a(l("input",{class:"info-input","onUpdate:modelValue":t[5]||(t[5]=e=>o.detailInfo.mgr=e),readonly:""},null,512),[[p,o.detailInfo.mgr]])]),t[16]||(t[16]=l("div",{class:"info-col info-right"},[l("label",null,"담당자"),l("input",{class:"info-input",value:"2조",readonly:""})],-1))]),l("div",H,[l("div",J,[t[17]||(t[17]=l("label",null,"주소",-1)),a(l("input",{class:"info-input","onUpdate:modelValue":t[6]||(t[6]=e=>o.detailInfo.ofc_addr=e),readonly:""},null,512),[[p,o.detailInfo.ofc_addr]])]),l("div",K,[t[18]||(t[18]=l("label",null,"출하일자",-1)),l("input",{class:"info-input",value:i.formatDateTime(o.detailInfo.spm_dt),readonly:""},null,8,P)]),t[19]||(t[19]=l("div",{class:"info-col info-right"},[l("label",null,"주소"),l("input",{class:"info-input",value:"대구광역시 중구 중앙대로 403",readonly:""})],-1))])])]),t[25]||(t[25]=l("br",null,null,-1)),l("table",R,[t[22]||(t[22]=l("thead",{class:"table-light"},[l("tr",null,[l("th",null,"제품번호"),l("th",null,"제품명"),l("th",null,"수량")])],-1)),l("tbody",null,[(m(!0),u(g,null,b(o.productList,e=>(m(),u("tr",{key:e.prd_no},[l("td",null,c(e.prd_no),1),l("td",null,c(e.prd_nm),1),l("td",null,c(e.qty),1)]))),128)),o.productList.length===0?(m(),u("tr",W,t[21]||(t[21]=[l("td",{colspan:"5"},"데이터가 없습니다.",-1)]))):y("",!0)])]),o.showOrdModal?(m(),S(r,{key:0,ordList:o.ordList,onSelectMat:i.handleSelectedOrd,onClose:t[7]||(t[7]=e=>o.showOrdModal=!1)},null,8,["ordList","onSelectMat"])):y("",!0)],64)}const tt=_(N,[["render",X]]);export{tt as default};
//# sourceMappingURL=SpmFns-jWxYu5ah.js.map
