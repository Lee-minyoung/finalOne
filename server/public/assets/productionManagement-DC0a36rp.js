import{_ as g,c as r,a as t,t as d,j as m,F as _,r as y,g as k,o as i,f as h,i as x,w as v,k as C,d as M,l as f,e as p,U as I,S as $,b as q}from"./index-CxFk6QSJ.js";import{u as F}from"./useDates-UMs5Kxim.js";import{S as c}from"./sweetalert2.esm.all-DV3w3JmD.js";const N={ì „ì²´:()=>!0,ì§„í–‰ì¤‘:e=>["l2","l3","l4"].includes(e.ln_sts),ëŒ€ê¸°ì¤‘:e=>e.ln_sts==="l1",ê³µì •ì§€ì‹œ:e=>e.ln_sts==="l2",ê³µì •í˜„í™©:e=>e.ln_sts==="l3",ê³µì •ì™„ë£Œ:e=>e.ln_sts==="l4",ì„¤ë¹„ì ê²€ì¤‘:e=>["l5","l6"].includes(e.ln_sts)},S={props:{item:Object,usedLines:Array},data(){return{selectedLine:this.item.selected_line||""}},computed:{filteredLineList(){const e=N[this.statusFilter]||(()=>!0);return this.LineList.filter(e)}}},B={class:"modal-dialog modal-lg"},V={class:"modal-content"},D={class:"modal-header"},j={class:"modal-title mb-0 fw-bold"},z={class:"modal-body"},T={class:"table table-sm table-bordered table-hover text-center align-middle"},U=["disabled","onClick"],A={key:0},E={key:1};function O(e,s,o,L,u,a){return i(),r("div",{class:"modal fade show d-block",id:"lineModal",style:{background:"rgba(0,0,0,0.5)","z-index":"1051"},onClick:s[1]||(s[1]=k(n=>e.$emit("close"),["self"]))},[t("div",B,[t("div",V,[t("div",D,[t("h5",j,"ë¼ì¸ ì„ íƒ - "+d(o.item.pdn_ord_no),1),t("button",{type:"button",class:"btn-close",onClick:s[0]||(s[0]=n=>e.$emit("close"))})]),t("div",z,[t("table",T,[s[4]||(s[4]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"ë¼ì¸ë²ˆí˜¸"),t("th",null,"ë¼ì¸ëª…"),t("th",null,"ìƒíƒœ"),t("th",null,"ì„ íƒ")])],-1)),t("tbody",null,[(i(!0),r(_,null,y(o.item.lineList.filter(n=>!o.usedLines.includes(n.ln_no)),n=>(i(),r("tr",{key:n.ln_no,class:h({"table-primary":u.selectedLine===n.ln_no})},[t("td",null,d(n.ln_no),1),t("td",null,d(n.ln_nm),1),t("td",null,[t("span",{class:h(["badge",{"bg-secondary":n.ln_sts==="l1","bg-info":n.ln_sts==="l2","bg-primary":n.ln_sts==="l3","bg-success":n.ln_sts==="l4","bg-danger":n.ln_sts==="l5","bg-warning text-dark":n.ln_sts==="l6","bg-dark":!["l1","l2","l3","l4","l5","l6"].includes(n.ln_sts)}])},d(n.ln_sts==="l1"?"ë¹„ê°€ë™":n.ln_sts==="l2"?"ëŒ€ê¸°ì¤‘":n.ln_sts==="l3"?"ê³µì •ì¤‘":n.ln_sts==="l4"?"ì¤€ë¹„ì¤‘":n.ln_sts==="l5"?"ìˆ˜ë¦¬ì¤‘":n.ln_sts==="l6"?"ì ê²€ì¤‘":"ì˜¤ë¥˜"),3)]),t("td",null,[t("button",{class:"btn btn-sm btn-outline-primary",disabled:n.ln_sts!=="l1",onClick:()=>{e.$emit("set-line",{...o.item,selected_line:n.ln_no}),e.$emit("close")}}," ì„ íƒ ",8,U)])],2))),128)),!o.item.lineList||o.item.lineList.length===0?(i(),r("tr",A,s[2]||(s[2]=[t("td",{colspan:"4",class:"text-center text-secondary"},"ë¼ì¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.",-1)]))):o.item.lineList.filter(n=>!o.usedLines.includes(n.ln_no)).length===0?(i(),r("tr",E,s[3]||(s[3]=[t("td",{colspan:"4",class:"text-center text-danger"},"ì„ íƒ ê°€ëŠ¥í•œ ë¼ì¸ì´ ì—†ìŠµë‹ˆë‹¤.",-1)]))):m("",!0)])])])])])])}const G=g(S,[["render",O],["__scopeId","data-v-5acc0ac6"]]),H={components:{LineInstructionModal:G},data(){return{instructionList:[],selectedItem:null,showLineModal:!1,statusFilter:"r1+q2"}},computed:{dateFormat(){return F.dateFormat},usedLines(){return this.instructionList.filter(e=>e.selected_line).map(e=>e.selected_line)},filteredList(){return this.instructionList.filter(e=>{if(this.statusFilter==="ì „ì²´")return!0;const[s,o]=this.statusFilter.split("+");return!(s&&e.ord_sts!==s||o&&e.mat_ins_sts!==o)})}},created(){this.fetchInstructions()},methods:{async fetchInstructions(){const e=await p.get("/api/prodinst");this.instructionList=e.data.map(s=>({...s,selected_line:""}))},openModal(e){this.selectedItem={...e},this.selectedItem.lineList=[],p.get("/api/lineDrop",{params:{pdn_ord_dtl_no:e.pdn_ord_dtl_no}}).then(s=>{this.selectedItem.lineList=s.data,this.showLineModal=!0})},setLine(e){const s=this.instructionList.findIndex(o=>o.pdn_ord_dtl_no===e.pdn_ord_dtl_no);s!==-1&&(this.instructionList[s].selected_line=e.selected_line)},async assignLine(e){if(!e.selected_line)return c.fire("â— ì•Œë¦¼","ë¼ì¸ì„ ë¨¼ì € ì§€ì •í•˜ì„¸ìš”.","warning");if(e.mat_ins_sts!=="q2")return c.fire("â— ì•Œë¦¼","ì…ê³ ì™„ë£Œ ìƒíƒœì—ì„œë§Œ ì§€ì‹œ ê°€ëŠ¥í•©ë‹ˆë‹¤.","info");try{await p.post("/api/preparingLine",{pdn_ord_dtl_no:e.pdn_ord_dtl_no,ln_no:e.selected_line}),await c.fire("âœ… ì„±ê³µ","ì§€ì‹œ ì™„ë£Œ!","success"),this.fetchInstructions(),this.showLineModal=!1}catch(s){console.error(s),c.fire("ì˜¤ë¥˜","ì§€ì‹œ ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.","error")}},async stopLine(e){if((await c.fire({title:"ì§€ì‹œë¥¼ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",text:`ì œí’ˆëª…: ${e.prd_nm}`,icon:"question",showCancelButton:!0,confirmButtonText:"ì˜ˆ",cancelButtonText:"ì•„ë‹ˆì˜¤"})).isConfirmed)try{await p.post("/api/stopLine",{pdn_ord_dtl_no:e.pdn_ord_dtl_no,ln_no:e.selected_line}),await c.fire("ì™„ë£Œ","ì§€ì‹œê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.","success"),this.fetchInstructions(),this.showLineModal=!1}catch(o){console.error(o),c.fire("ì˜¤ë¥˜","ì·¨ì†Œ ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.","error")}},viewCompleteStatus(e){c.fire({title:"âœ… ì™„ë£Œí˜„í™©",html:`
        <div style="text-align:left; line-height:1.7">
          <strong>ì§€ì‹œID:</strong> ${e.pdn_ord_no}<br>
          <strong>ì œí’ˆëª…:</strong> ${e.prd_nm}<br>
          <strong>ì§€ì‹œìˆ˜ëŸ‰:</strong> ${e.lo_ord_qty}ê°œ<br>
          <strong>ë¶ˆëŸ‰ìˆ˜ëŸ‰:</strong> ${e.dft_qty}ê°œ<br>
          <strong>ìƒì‚°ìˆ˜ëŸ‰:</strong> ${e.pdn_qty}ê°œ<br>
          <strong>ì§€ì‹œì:</strong> ${e.mgr}<br>
          <strong>ì™„ë£Œì¼ì:</strong> ${this.dateFormat(e.end_tm,"yyyy-MM-dd   hhì‹œ mmë¶„")}<br>

        </div>
      `,icon:"info"})},formatNumber(e){return e==null||isNaN(e)?"-":new Intl.NumberFormat().format(e)}}},J={class:"container mt-4"},K={class:"d-flex justify-content-end mb-3"},P={class:"table table-bordered text-center",style:{"min-width":"1200px"}},Q={class:"d-flex align-items-center justify-content-center gap-2"},R={key:0},W={key:1,class:"text-muted"},X=["onClick"],Y=["onClick"],Z={colspan:"1"},tt=["onClick"],et=["onClick"];function st(e,s,o,L,u,a){const n=f("router-link"),w=f("LineInstructionModal");return i(),r("div",J,[s[7]||(s[7]=t("h2",{class:"mb-4"},"ìƒì‚°ì§€ì‹œí˜„í™©",-1)),t("div",K,[v(t("select",{"onUpdate:modelValue":s[0]||(s[0]=l=>u.statusFilter=l),class:"form-select w-auto"},s[2]||(s[2]=[M('<option value="ì „ì²´" data-v-886d0620>ì „ì²´</option><option value="r1+q2" data-v-886d0620>ì§€ì‹œ ê°€ëŠ¥</option><option value="r1+q1" data-v-886d0620>ì§€ì‹œ ëŒ€ê¸°</option><option value="r2" data-v-886d0620>ì§€ì‹œ ì™„ë£Œ</option><option value="r3" data-v-886d0620>ìƒì‚° ì™„ë£Œ</option>',5)]),512),[[C,u.statusFilter]])]),t("table",P,[s[5]||(s[5]=t("colgroup",null,[t("col",{style:{width:"120px"}}),t("col",{style:{width:"180px"}}),t("col",{style:{width:"120px"}}),t("col",{style:{width:"140px"}}),t("col",{style:{width:"120px"}}),t("col",{style:{width:"120px"}}),t("col",{style:{width:"120px"}}),t("col",{style:{width:"100px"}})],-1)),s[6]||(s[6]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"ì§€ì‹œë²ˆí˜¸"),t("th",null,"ì œí’ˆëª…"),t("th",null,"ì§€ì‹œìˆ˜ëŸ‰"),t("th",null,"ì§€ì‹œì¼ì"),t("th",null,"ì§€ì‹œì"),t("th",null,"ì¬ë£Œ ì…ê³ "),t("th",null,"ë¼ì¸ ì§€ì •"),t("th",null,"í˜„í™©")])],-1)),t("tbody",null,[(i(!0),r(_,null,y(a.filteredList,l=>(i(),r("tr",{key:l.pdn_ord_dtl_no},[t("td",null,d(l.pdn_ord_no),1),t("td",null,d(l.prd_nm),1),t("td",null,d(a.formatNumber(l.ord_qty)),1),t("td",null,d(a.dateFormat(l.pdn_ord_dt,"yyyy-MM-dd")),1),t("td",null,d(l.crt_by),1),l.ord_sts==="r1"?(i(),r(_,{key:0},[t("td",null,[t("span",{class:h(["badge",{"bg-warning text-dark":l.mat_ins_sts==="q1","bg-success":l.mat_ins_sts==="q2"}])},d(l.mat_ins_sts==="q1"?"ì…ê³ ëŒ€ê¸°":l.mat_ins_sts==="q2"?"ì…ê³ ì™„ë£Œ":"ì˜¤ë¥˜"),3)]),t("td",null,[t("div",Q,[l.selected_line?(i(),r("span",R,d(l.selected_line),1)):(i(),r("span",W,"ë¯¸ì§€ì •")),t("button",{class:"btn btn-outline-secondary",onClick:b=>a.openModal(l)}," ğŸ” ",8,X)])]),t("td",null,[t("button",{class:"btn btn-sm btn-primary",onClick:b=>a.assignLine(l)},"ì§€ì‹œ",8,Y)])],64)):l.ord_sts==="r2"?(i(),r(_,{key:1},[t("td",Z,[I(n,{to:"/LineMang",class:"badge text-dark text-decoration-none",style:{"background-color":"#aee2f8","font-size":"0.95rem",padding:"0.5rem 1.2rem",display:"inline-block","min-width":"110px","text-align":"center"}},{default:$(()=>s[3]||(s[3]=[q(" ìƒì‚°ì§€ì‹œì™„ë£Œ ")])),_:1,__:[3]})]),t("td",null,[t("span",null,d(l.ln_no),1)]),t("td",null,[t("button",{class:"btn btn-sm btn-danger",onClick:b=>a.stopLine(l)},"ì·¨ì†Œ",8,tt)])],64)):l.ord_sts==="r3"?(i(),r(_,{key:2},[s[4]||(s[4]=t("td",{colspan:"2"},[t("span",{class:"badge text-white",style:{"background-color":"#6c757d","font-size":"0.95rem",padding:"0.5rem 1.2rem",display:"inline-block","min-width":"110px","text-align":"center"}}," ìƒì‚°ê³µì •ì™„ë£Œ ")],-1)),t("td",null,[t("button",{class:"btn btn-sm btn-outline-info",onClick:b=>a.viewCompleteStatus(l)}," ì™„ë£Œí˜„í™© ",8,et)])],64)):m("",!0)]))),128))])]),u.showLineModal?(i(),x(w,{key:0,item:u.selectedItem,"used-lines":a.usedLines,onSetLine:a.setLine,onClose:s[1]||(s[1]=l=>u.showLineModal=!1)},null,8,["item","used-lines","onSetLine"])):m("",!0)])}const it=g(H,[["render",st],["__scopeId","data-v-886d0620"]]);export{it as default};
//# sourceMappingURL=productionManagement-DC0a36rp.js.map
