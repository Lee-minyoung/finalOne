{"version":3,"file":"spmInstTest-mgD5dAn9.js","sources":["../../../client/src/views/sales/spmInstTest.vue"],"sourcesContent":["<template>\n  <div class=\"col-md-10 p-4\">\n    <h4 class=\"mb-4\">출하지시</h4>\n\n    <!-- 출하지시 입력 폼 -->\n    <div class=\"row mb-3 g-3\">\n      <div class=\"col-md-3\">\n        <label class=\"form-label\">출하일자</label>\n        <input v-model=\"spmDate\" type=\"date\" class=\"form-control\" />\n      </div>\n\n      <div class=\"col-md-3\">\n        <label class=\"form-label\">담당자</label>\n        <input type=\"text\" v-model=\"manager\" class=\"form-control\" />\n      </div>\n    </div>\n\n    <!-- 수주 목록 테이블 -->\n    <table class=\"table table-bordered text-center mt-4\">\n      <thead class=\"table-light\">\n        <tr>\n          <th>주문ID</th>\n          <th>거래처ID</th>\n          <th>거래처명</th>\n          <th>제품ID</th>\n          <th>제품명</th>\n          <th>요청수량</th>\n          <th>lot재고량</th>\n          <th>납기일자</th>\n          <th>상태</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr\n          v-for=\"item in ords\"\n          :key=\"item.ord_no\"\n          @click=\"toggleOrder(item)\"\n          :class=\"{ 'table-primary': isSelected(item) }\"\n          style=\"cursor: pointer\"\n        >\n          <td>{{ item.ord_no }}</td>\n          <td>{{ item.vdr_no }}</td>\n          <td>{{ item.cpy_nm }}</td>\n          <td>{{ item.prd_no }}</td>\n          <td>{{ item.prd_nm }}</td>\n          <td>{{ item['요청수량'] }}</td>\n          <td>{{ item['lot수량'] <= 0 ? 0 : item['lot수량'] }}</td>\n          <td>{{ item['납기예정'] }}</td>\n          <td>\n            <span\n              class=\"badge\"\n              :class=\"item['요청수량'] < item['lot수량'] ? 'text-bg-primary' : 'text-bg-danger'\"\n            >\n              {{ item['요청수량'] < item['lot수량'] ? '출하가능' : '출하대기' }}\n            </span>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n\n    <!-- 출하지시 버튼 -->\n    <div class=\"d-flex justify-content-end mt-3\">\n      <button class=\"btn btn-primary\" @click=\"saveSpm\">출하지시</button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\n\nexport default {\n  name: 'SpmInst',\n  data() {\n    return {\n      spmDate: '',\n      manager: '',\n      selectedOrders: [],\n      ords: []\n    };\n  },\n  async created() {\n    const ords = await axios.get('/api/ord');\n    this.ords = ords.data;\n  },\n  methods: {\n    isSelected(item) {\n      return this.selectedOrders.includes(item);\n    },\n    toggleOrder(item) {\n      const index = this.selectedOrders.indexOf(item);\n      if (index > -1) {\n        this.selectedOrders.splice(index, 1);\n      } else {\n        this.selectedOrders.push(item);\n      }\n    },\n\n    async saveSpm() {\n      if (!this.selectedOrders.length) {\n        alert('수주를 선택하세요');\n        return;\n      }\n\n      for (const item of this.selectedOrders) {\n        if (Number(item['요청수량']) > Number(item['lot수량']) || Number(item['lot수량']) <= 0) {\n          alert(`수주번호 ${item.ord_no}는 출하할 수 없습니다.`);\n          return;\n        }\n      }\n\n      try {\n        const payloads = this.selectedOrders.map(item => ({\n          ord_no: item.ord_no,\n          dlv_addr: item.ofc_addr,\n          spm_dt: item['납기예정'],\n          vdr_no: item.vdr_no,\n          lot_no: item.lot_no,\n          prd_no: item.prd_no,\n          lot_qty: item['lot수량'],\n          memo: item.ord_no,\n          req_qty: Number(item['요청수량'])\n        }));\n\n        await axios.post('/api/addSpms', payloads);\n        this.ords=await axios.get('/api/ord');\n        alert('출하지시 완료!');\n        this.selectedOrders = [];\n\n        const ords = await axios.get('/api/ord');\n        this.ords = ords.data;\n      } catch (err) {\n        console.error(err);\n        alert('출하지시 중 오류 발생');\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.table-primary {\n  background-color: #cce5ff;\n}\n</style>"],"names":["_sfc_main","ords","axios","item","index","payloads","err","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_openBlock","_createElementBlock","_cache","_createElementVNode","$event","$data","_Fragment","_renderList","$options","_normalizeClass","_toDisplayString","args"],"mappings":"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"}