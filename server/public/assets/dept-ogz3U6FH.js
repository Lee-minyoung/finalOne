import{d as v}from"./useCommonCode-DKmraWxZ.js";import{_ as g,e as u,c as f,a as e,i as y,j as I,w as d,v as i,k as D,l as h,o as r,F as w,r as M,f as F,t as b}from"./index-DRp0-N0C.js";import{u as C}from"./useDates-UMs5Kxim.js";import{e as _}from"./empSelectModal-DIkxnxAD.js";import{u as E}from"./useDates2-sS5pNIz9.js";const L={components:{empSelectModal:_},props:{dept:Object},data(){return{deptInfo:{},empList:[],showEmpModal:!1,selectedEmp:null}},watch:{dept:{handler(o){o?this.getDeptInfo(o.dept_no):this.deptInfo={}},immediate:!0}},computed:{formattedCrtDt(){return this.deptInfo.crt_dt?this.dateFormat(this.deptInfo.crt_dt):""},formattedMdfDt(){return this.deptInfo.mdf_dt?this.dateFormat(this.deptInfo.mdf_dt):""}},methods:{dateFormat(o){return C.dateFormat(o,"yyyy-MM-dd")},getDate(o){return this.dateFormat(o)},async getDeptInfo(o){let t=await u.get(`/api/dept/${o}`).catch(p=>console.log(p));console.log(t),this.deptInfo=t.data,console.log(this.deptInfo)},async deptUpdate(){var a;if(!((a=this.deptInfo.dept_nm)!=null&&a.trim())){alert("부서명을 입력해주세요.");return}if(!this.deptInfo.dept_mgr){alert("부서관리자를 선택해주세요.");return}if(!this.deptInfo.use_yn){alert("사용여부를 선택해주세요.");return}let o={dept_nm:this.deptInfo.dept_nm,dept_mgr:this.deptInfo.dept_mgr,use_yn:this.deptInfo.use_yn};(await u.put(`/api/dept/${this.deptInfo.dept_no}`,o).catch(l=>console.log(l))).data.isUpdated?(alert("수정되었습니다."),this.$emit("dept-reload"),this.getDeptInfo(this.deptInfo.dept_no)):alert(`수정되지 않았습니다.
데이터를 확인해보세요.`)},saveDept(){confirm(`정말로 수정하시겠습니까?
변경된 내용은 즉시 적용됩니다.`)&&this.deptUpdate()},addDept(){this.$emit("goToForm",!1)},async deleteDept(o){o>0?confirm(`정말로 삭제하시겠습니까?
삭제된 데이터는 복구할 수 없습니다.`)&&((await u.delete(`/api/dept/${o}`).catch(l=>console.log(l))).data.affectedRows>0?(this.deptInfo={},this.$emit("clear-selection"),this.$emit("dept-reload"),alert("정상적으로 삭제되었습니다.")):alert("삭제되지 않았습니다.")):alert("삭제할 부서를 선택하세요")},resetForm(){this.getDeptInfo(this.deptInfo.dept_no)},openEmpModal(){u.get("/api/emp").then(o=>{this.empList=o.data,this.showEmpModal=!0}).catch(o=>{console.error("사원 목록 불러오기 실패",o)})},handleSelectedEmp(o){this.deptInfo.dept_mgr=o.emp_no,this.deptInfo.nm=o.nm,this.showEmpModal=!1}}},k={class:"col-md-6"},x={class:"d-flex justify-content-between mb-3"},V={class:"card p-3"},S={key:0},U={class:"input-group"},R={key:1};function T(o,t,p,a,l,n){const c=h("empSelectModal");return r(),f("div",k,[e("div",x,[e("div",null,[e("button",{class:"btn btn-primary me-2",onClick:t[0]||(t[0]=(...s)=>n.addDept&&n.addDept(...s))},"등록"),e("button",{class:"btn btn-danger",onClick:t[1]||(t[1]=s=>n.deleteDept(l.deptInfo.dept_no))},"삭제")]),e("div",null,[e("button",{class:"btn btn-warning me-2",onClick:t[2]||(t[2]=(...s)=>n.resetForm&&n.resetForm(...s))},"초기화"),e("button",{class:"btn btn-success",onClick:t[3]||(t[3]=(...s)=>n.saveDept&&n.saveDept(...s))},"저장")])]),e("div",V,[t[20]||(t[20]=e("h4",null,"상세 보기",-1)),p.dept?(r(),f("div",S,[e("div",null,[t[13]||(t[13]=e("label",{class:"form-label"},"부서번호",-1)),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=s=>l.deptInfo.dept_no=s),readonly:"",disabled:""},null,512),[[i,l.deptInfo.dept_no]]),t[14]||(t[14]=e("label",{class:"form-label"},"부서명",-1)),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=s=>l.deptInfo.dept_nm=s)},null,512),[[i,l.deptInfo.dept_nm]]),t[15]||(t[15]=e("label",{class:"form-label"},"부서관리자",-1)),e("div",U,[d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.deptInfo.nm=s),type:"text",class:"form-control",readonly:""},null,512),[[i,l.deptInfo.nm]]),e("button",{class:"btn btn-outline-secondary",onClick:t[7]||(t[7]=s=>n.openEmpModal())},"사원 선택")]),t[16]||(t[16]=e("label",{class:"form-label"},"사용여부",-1)),d(e("select",{class:"form-select form-control","onUpdate:modelValue":t[8]||(t[8]=s=>l.deptInfo.use_yn=s)},t[12]||(t[12]=[e("option",{value:"f1"},"여",-1),e("option",{value:"f2"},"부",-1)]),512),[[D,l.deptInfo.use_yn]]),t[17]||(t[17]=e("label",{class:"form-label"},"등록일자",-1)),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=s=>n.formattedCrtDt=s),readonly:"",disabled:""},null,512),[[i,n.formattedCrtDt]]),t[18]||(t[18]=e("label",{class:"form-label"},"수정일자",-1)),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[10]||(t[10]=s=>n.formattedMdfDt=s),readonly:"",disabled:""},null,512),[[i,n.formattedMdfDt]])])])):(r(),f("div",R,t[19]||(t[19]=[e("p",null,"부서를 선택하세요!",-1)])))]),l.showEmpModal?(r(),y(c,{key:0,empList:l.empList,selected:l.deptInfo.dept_mgr,onSelectEmp:n.handleSelectedEmp,onClose:t[11]||(t[11]=s=>l.showEmpModal=!1)},null,8,["empList","selected","onSelectEmp"])):I("",!0)])}const N=g(L,[["render",T],["__scopeId","data-v-f8ca02ca"]]),j={components:{empSelectModal:_},data(){return{deptNo:"",today:"",deptInfo:{dept_nm:"",dept_mgr:"",nm:""},empList:[],showEmpModal:!1,selectedEmp:null}},created(){this.getDeptNo(),this.getToday()},methods:{getToday(){this.today=E.dateFormat(null,"yyyy-MM-dd")},async getDeptNo(){let o=await u.get("/api/deptNo").catch(t=>console.log(t));this.deptNo=o.data[0].addDeptNo},resetForm(){this.deptInfo.dept_nm=null,this.deptInfo.dept_mgr=null},async deptInsert(){var a;if(!((a=this.deptInfo.dept_nm)!=null&&a.trim())){alert("부서명을 입력해주세요.");return}if(!this.deptInfo.dept_mgr){alert("부서관리자를 선택해주세요.");return}let o={dept_nm:this.deptInfo.dept_nm,dept_mgr:this.deptInfo.dept_mgr};(await u.post("/api/dept",o).catch(l=>console.log(l))).data.isSuccessed?(alert("등록되었습니다."),this.$emit("dept-reload")):alert(`등록되지 않았습니다.
데이터를 확인해보세요.`),this.$emit("goToInfo",!0)},openEmpModal(){u.get("/api/emp").then(o=>{this.empList=o.data,this.showEmpModal=!0}).catch(o=>{console.error("사원 목록 불러오기 실패",o)})},handleSelectedEmp(o){this.deptInfo.dept_mgr=o.emp_no,this.deptInfo.nm=o.nm,this.showEmpModal=!1}}},q={class:"col-md-6"},B={class:"d-flex justify-content-between mb-3"},G={class:"card p-3"},Q={class:"input-group"};function z(o,t,p,a,l,n){const c=h("empSelectModal");return r(),f("div",q,[e("div",B,[t[8]||(t[8]=e("div",null,null,-1)),e("div",null,[e("button",{class:"btn btn-warning me-2",onClick:t[0]||(t[0]=(...s)=>n.resetForm&&n.resetForm(...s))},"초기화"),e("button",{class:"btn btn-success",onClick:t[1]||(t[1]=(...s)=>n.deptInsert&&n.deptInsert(...s))},"저장")])]),e("div",G,[t[15]||(t[15]=e("h4",null,"부서 등록",-1)),e("div",null,[e("div",null,[t[9]||(t[9]=e("label",{class:"form-label"},"부서번호",-1)),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=s=>l.deptNo=s),readonly:"",disabled:""},null,512),[[i,l.deptNo]]),t[10]||(t[10]=e("label",{class:"form-label"},"부서명",-1)),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=s=>l.deptInfo.dept_nm=s)},null,512),[[i,l.deptInfo.dept_nm]]),t[11]||(t[11]=e("label",{class:"form-label"},"부서관리자",-1)),e("div",Q,[d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.deptInfo.nm=s),type:"text",class:"form-control",readonly:""},null,512),[[i,l.deptInfo.nm]]),e("button",{class:"btn btn-outline-secondary",onClick:t[5]||(t[5]=s=>n.openEmpModal())},"사원 선택")]),t[12]||(t[12]=e("label",{class:"form-label"},"사용여부",-1)),t[13]||(t[13]=e("input",{type:"text",class:"form-control",value:"여",readonly:"",disabled:""},null,-1)),t[14]||(t[14]=e("label",{class:"form-label"},"등록일자",-1)),d(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=s=>l.today=s),readonly:"",disabled:""},null,512),[[i,l.today]])])]),l.showEmpModal?(r(),y(c,{key:0,empList:l.empList,selected:l.deptInfo.dept_mgr,onSelectEmp:n.handleSelectedEmp,onClose:t[7]||(t[7]=s=>l.showEmpModal=!1)},null,8,["empList","selected","onSelectEmp"])):I("",!0)])])}const O=g(j,[["render",z],["__scopeId","data-v-c0395b26"]]),A={components:{deptInfo:N,deptForm:O},data(){return{searchQuery:"",selectedFilter:"",selectedDept:null,deptList:[],InfoView:!0}},computed:{filteredDeptList(){return this.deptList.filter(o=>o.dept_nm.toLowerCase().includes(this.searchQuery.toLowerCase())&&(this.selectedFilter===""||o.dept_nm===this.selectedFilter))}},created(){this.getDeptList()},methods:{CommonCodeFormat(o){return v.CommonCodeFormat(o)},async getDeptList(){let o=await u.get("/api/dept").catch(t=>console.log(t));this.deptList=o.data},async selectDept(o){try{const t=this.deptList.find(p=>p.dept_no===o);this.InfoView=!0,await this.$nextTick(),this.selectedDept=t}catch(t){console.error("부서 선택 중 오류 발생:",t)}},msg(o){this.InfoView=o,o||(this.selectedDept=null)}}},H={class:"container mt-4"},J={class:"row"},K={class:"col-md-6"},P={class:"d-flex justify-content-between mb-3"},W={class:"card p-3"},X={class:"table-container"},Y={class:"table table-container"},Z=["onClick"],$={class:"w-10"},tt={class:"w-20"},et={class:"w-15"},ot={class:"w-10"};function lt(o,t,p,a,l,n){const c=h("deptInfo"),s=h("deptForm");return r(),f("div",H,[e("div",J,[t[3]||(t[3]=e("h1",null,"부서관리",-1)),e("div",K,[e("div",P,[d(e("input",{type:"text",class:"form-control w-50",placeholder:"부서명 검색...","onUpdate:modelValue":t[0]||(t[0]=m=>l.searchQuery=m)},null,512),[[i,l.searchQuery]])]),e("div",W,[t[2]||(t[2]=e("h4",null,"부서 목록",-1)),e("div",X,[e("table",Y,[t[1]||(t[1]=e("thead",null,[e("tr",null,[e("th",{class:"w-10"},"부서번호"),e("th",{class:"w-20"},"부서명"),e("th",{class:"w-15"},"부서관리자"),e("th",{class:"w-10"},"사용여부")])],-1)),e("tbody",null,[(r(!0),f(w,null,M(n.filteredDeptList,m=>(r(),f("tr",{key:m.dept_no,onClick:st=>n.selectDept(m.dept_no),class:F([{"table-primary":l.selectedDept&&l.selectedDept.dept_no===m.dept_no},"table-hover"])},[e("td",$,b(m.dept_no),1),e("td",tt,b(m.dept_nm),1),e("td",et,b(m.nm),1),e("td",ot,b(n.CommonCodeFormat(m.use_yn)),1)],10,Z))),128))])])])])]),l.InfoView?(r(),y(c,{key:0,dept:l.selectedDept,onGoToForm:n.msg,onDeptReload:n.getDeptList},null,8,["dept","onGoToForm","onDeptReload"])):I("",!0),l.InfoView?I("",!0):(r(),y(s,{key:1,onGoToInfo:n.msg,onDeptReload:n.getDeptList},null,8,["onGoToInfo","onDeptReload"]))])])}const at=g(A,[["render",lt],["__scopeId","data-v-86672f73"]]);export{at as default};
//# sourceMappingURL=dept-ogz3U6FH.js.map
