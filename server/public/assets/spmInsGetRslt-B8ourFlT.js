import{_ as L,c as u,a as t,w as M,v as P,F as g,r as w,g as k,o as i,t as n,i as x,j as S,b as a,f as _,l as D,e as h,m as N}from"./index-DRp0-N0C.js";import{u as C}from"./useDates-UMs5Kxim.js";const R={props:{prodList:{type:Array,default:()=>[]}},data(){return{search:""}},computed:{filteredProducts(){return this.prodList?this.prodList.filter(s=>{var e;return(e=s.prd_nm)==null?void 0:e.includes(this.search)}):[]}},methods:{selectProduct(s){this.$emit("select-product",s),this.$emit("close")}},mounted(){console.log("모달에 전달된 prodList:",this.prodList)}},j={class:"modal-dialog modal-lg"},G={class:"modal-content"},T={class:"modal-header"},V={class:"modal-body"},B={class:"d-flex justify-content-between align-items-center mb-2"},F={class:"table table-sm table-bordered text-center"},Q=["onClick"];function A(s,e,c,p,l,d){return i(),u("div",{class:"modal fade show d-block",style:{background:"rgba(0,0,0,0.5)","z-index":"1051"},onClick:e[2]||(e[2]=k(o=>s.$emit("close"),["self"]))},[t("div",j,[t("div",G,[t("div",T,[e[3]||(e[3]=t("h5",{class:"modal-title"},"제품 선택",-1)),t("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=o=>s.$emit("close"))})]),t("div",V,[t("div",B,[M(t("input",{type:"text",class:"form-control w-25",placeholder:"제품명 검색","onUpdate:modelValue":e[1]||(e[1]=o=>l.search=o),id:"searchProduct"},null,512),[[P,l.search]])]),t("table",F,[e[4]||(e[4]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"라인번호"),t("th",null,"제품명")])],-1)),t("tbody",null,[(i(!0),u(g,null,w(d.filteredProducts,o=>(i(),u("tr",{key:o.ln_opr_no+"-"+o.prd_nm,onClick:m=>d.selectProduct(o),style:{cursor:"pointer"}},[t("td",null,n(o.ln_opr_no),1),t("td",null,n(o.prd_nm),1)],8,Q))),128))])])])])])])}const J=L(R,[["render",A],["__scopeId","data-v-c2e49a7f"]]);N(!1);const U={components:{PrdGetSelModal:J},data(){return{searchQuery:"",selectedLineId:"",selectedProductName:"",selectedInsDate:this.getToday(),newItemList:[],spmInsStdList:[],prodList:[],rsltMaster:null,rsltDetailList:[],showProductModal:!1,newItem:[],overallJdg:"",selectedRsltNo:""}},created(){this.selectedInsDev=localStorage.getItem("username")||""},methods:{getJdgName(s){return s==="o1"?"적합":s==="o2"?"부적합":s||""},getToday(){return new Date().toISOString().slice(0,10)},dateFormat(s,e){return C.dateFormat(s,e)},async fetchRsltDetail(s,e){var p;const c=await h.get("/api/spmInsGetRslt/detail",{params:{prd_no:s,ln_opr_no:e}});this.rsltMaster=c.data.master,this.rsltDetailList=c.data.detail,this.selectedRsltNo=((p=this.rsltMaster)==null?void 0:p.rslt_no)||"",console.log(this.rsltDetailList)},showModal(){this.showProductModal=!0},hideModal(){this.showProductModal=!1},openProductModal(){h.get("/api/spmInsGetRsltRouter/prdList").then(s=>{console.log("제품목록:",s.data),this.prodList=Array.isArray(s.data)?s.data:[],this.showProductModal=!0}).catch(s=>{console.error("제품 목록 불러오기 실패",s),this.prodList=[]})},async handleSelectedProduct(s){this.selectedLineId=s.ln_opr_no,this.selectedProductName=s.prd_nm,this.searchQuery=s.prd_no,this.selectedInsDate=this.getToday(),this.showProductModal=!1,await this.fetchRsltDetail(s.prd_no,s.ln_opr_no)},async getSpmInsStdList(s){try{const e=await h.get("/api/spmGetInsStd",{params:{prd_no:s}});this.spmInsStdList=e.data,this.newItemList=this.spmInsStdList.map(()=>({mgr_rslt:"",rmk:""}))}catch{alert("기준서 목록을 가져오는 중 오류가 발생했습니다.")}}}},z={class:"container mt-4"},$={class:"input"},E=["value"],O=["value"],q=["value"],H=["value"],K=["value"],W={class:"middle"},X={class:"table table-bordered text-center",id:"table"},Y={class:"rst"},Z={class:"hstack gap-3"},tt={class:"table table-bordered text-center"};function et(s,e,c,p,l,d){var m,b,y,f,v;const o=D("PrdGetSelModal");return i(),u(g,null,[t("div",z,[e[15]||(e[15]=t("div",{class:"d-flex justify-content-between align-items-center mb-4"},[t("div",{class:"d-flex gap-4"},[t("h2",{class:"mb-4"},"완제품검사성적서 조회")])],-1)),t("div",$,[e[3]||(e[3]=a(" 제품검색 ")),M(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>l.searchQuery=r),class:"form-control",id:"input_id",placeholder:"",readonly:""},null,512),[[P,l.searchQuery]]),t("button",{class:"btn btn-outline-secondary",id:"icon-btn",onClick:e[1]||(e[1]=(...r)=>d.openProductModal&&d.openProductModal(...r)),style:{"margin-right":"505px"}},"🔍"),e[4]||(e[4]=a(" 성적서번호 ")),t("input",{value:l.selectedRsltNo,class:"form-control",id:"input",readonly:"",style:{"background-color":"#eee"}},null,8,E),e[5]||(e[5]=t("hr",{style:{"margin-left":"-75px"}},null,-1)),e[6]||(e[6]=a(" 라인번호 ")),t("input",{value:l.selectedLineId,class:"form-control",id:"input",readonly:"",style:{"background-color":"#eee"}},null,8,O),e[7]||(e[7]=a(" 제품명 ")),t("input",{value:l.selectedProductName,class:"form-control",id:"input",readonly:"",style:{"background-color":"#eee"}},null,8,q),e[8]||(e[8]=a(" 작성일자 ")),t("input",{value:l.selectedInsDate,class:"form-control",id:"input",readonly:"",style:{"background-color":"#eee"}},null,8,H),e[9]||(e[9]=a(" 검사자 ")),t("input",{value:s.selectedInsDev,class:"form-control",id:"input",readonly:"",style:{"background-color":"#eee"}},null,8,K)]),e[16]||(e[16]=t("br",null,null,-1)),t("div",W,[t("div",null,[t("table",X,[e[11]||(e[11]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"결점구분"),t("th",null,"검사량"),t("th",null,"합격량"),t("th",null,"불량량")])],-1)),t("tbody",null,[t("tr",null,[e[10]||(e[10]=t("td",null,"수량",-1)),t("td",null,n((m=l.rsltMaster)==null?void 0:m.mgr_count),1),t("td",null,n((b=l.rsltMaster)==null?void 0:b.succ_count),1),t("td",null,n((y=l.rsltMaster)==null?void 0:y.dft_count),1)])])])]),t("div",Y,[t("div",Z,[e[12]||(e[12]=t("div",{style:{"padding-left":"50px"}},"종합판정",-1)),e[13]||(e[13]=t("div",{class:"vr"},null,-1)),t("button",{class:_(["jdg-btn",((f=l.rsltMaster)==null?void 0:f.ovr_jdg)==="n1"?"btn-green":""]),style:{width:"150px",height:"100px","border-radius":"5px","border-color":"lightgray"}},"합격",2),t("button",{class:_(["jdg-btn",((v=l.rsltMaster)==null?void 0:v.ovr_jdg)==="n2"?"btn-red":""]),style:{width:"150px",height:"100px","border-radius":"5px","border-color":"lightgray"}},"불합격",2)])])]),e[17]||(e[17]=t("h5",null,"검사결과",-1)),t("table",tt,[e[14]||(e[14]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"검사항목"),t("th",null,"검사기준"),t("th",null,"검사결과"),t("th",null,"판정"),t("th",null,"비고")])],-1)),t("tbody",null,[(i(!0),u(g,null,w(l.rsltDetailList,(r,I)=>(i(),u("tr",{key:I},[t("td",null,n(r.ins_itm),1),t("td",null,n(r.ins_mthd),1),t("td",null,n(r.mgr_rslt),1),t("td",null,n(d.getJdgName(r.jdg)),1),t("td",null,n(r.rmk),1)]))),128))])])]),l.showProductModal?(i(),x(o,{key:0,prodList:l.prodList,onSelectProduct:d.handleSelectedProduct,onClose:e[2]||(e[2]=r=>l.showProductModal=!1)},null,8,["prodList","onSelectProduct"])):S("",!0)],64)}const ot=L(U,[["render",et]]);export{ot as default};
//# sourceMappingURL=spmInsGetRslt-B8ourFlT.js.map
