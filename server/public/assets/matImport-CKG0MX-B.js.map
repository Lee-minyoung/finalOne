{"version":3,"file":"matImport-CKG0MX-B.js","sources":["../../../client/src/views/inventory/matImport.vue"],"sourcesContent":["<template>\n  <div class=\"col-md-10 p-4\">\n    <!-- 상단 제목 -->\n    <div class=\"d-flex justify-content-between align-items-center mb-3\">\n      <h4 class=\"mb-0\">입고처리</h4>\n    </div>\n\n    <!-- 입력 박스 -->\n    <div class=\"card p-3 mb-4\">\n      <!-- 카드 상단에 버튼 정렬 -->\n      <div class=\"d-flex justify-content-end mb-3\">\n        <button class=\"btn btn-primary btn-sm\" @click=\"manyImports\">자재입고</button>\n      </div>\n\n      <div class=\"row g-3\">\n        <!-- 담당자 -->\n        <div class=\"col-md-4\">\n          <label class=\"form-label\">담당자</label>\n          <input v-model=\"employeeName\" class=\"form-control\" type=\"text\" placeholder=\"예담창고\" disabled>\n        </div>\n\n        <!-- 창고번호 -->\n        <div class=\"col-md-4\">\n          <label class=\"form-label\">창고번호</label>\n          <input class=\"form-control\" type=\"text\" placeholder=\"예담창고\" disabled>\n        </div>\n\n        <!-- 수령방법 -->\n        <div class=\"col-md-4\">\n          <label class=\"form-label\">수령방법</label>\n          <select class=\"form-select\" v-model=\"rcvrMth\">\n            <option value=\"1\">수령방법1</option>\n            <option value=\"2\">수령방법2</option>\n            <option value=\"3\">수령방법3</option>\n          </select>\n        </div>\n      </div>\n    </div>\n\n    <!-- 제품 목록 테이블 -->\n    <table class=\"table table-bordered text-center mt-4\">\n      <thead class=\"table-light\">\n        <tr>\n          <th>발주번호</th>\n          <th>자재ID</th>\n          <th>자재명</th>\n          <th>수량</th>\n          <th>유통기한</th>\n          <th>거래처ID</th>\n          <th>거래처명</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"item in purToLotStatus\" :key=\"item.pur_ord_no\" :class=\"{ 'table-primary': isSelected(item) }\"\n          @click=\"toggleRow(item)\" style=\"cursor: pointer;\">\n          <td>{{ item.pur_ord_no }}</td>\n          <td>{{ item.mat_no }}</td>\n          <td>{{ item['자재명'] }}</td>\n          <td>{{ item.qty }}</td>\n          <td>{{ item['유통기한'] }}</td>\n          <td>{{ item.vdr_no }}</td>\n          <td>{{ item['거래처명'] }}</td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport { useEmpStore } from '@/stores/empStore.js';\nimport Swal from 'sweetalert2';\n\nexport default {\n  data() {\n    return {\n      purToLotStatus: [],\n      checkPur: [],\n      purOrdNo: 0,\n      matNo: '',\n      wareNo: 0,\n      expDt: '',\n      prcsr: '',\n      rcvr: 0,\n      rcvrMth: '1',\n      empStore: useEmpStore(),\n    };\n  },\n  async created() {\n    const result = await axios.get('/api/ordToLot');\n    this.purToLotStatus = result.data;\n  },\n  computed: {\n    employeeName() {\n      return this.empStore.loginInfo.nm || '';\n    },\n  },\n  methods: {\n    async manyImports() {\n      const selectedOrds = this.purToLotStatus.filter(order => {\n        return this.checkPur.map(p => p.pur_ord_no).includes(order.pur_ord_no);\n      });\n\n      const payloads = selectedOrds.map(item => ({\n        mat_no: item.mat_no,\n        qty: item.qty,\n        warehouse_no: this.wareNo,\n        cnsm_lmt_dt: item['유통기한'],\n        unt_prc: item.unt_prc,\n        pur_ord_no: item.pur_ord_no,\n        prcsr: this.empStore.loginInfo.emp_no,\n        vdr_no: item.vdr_no,\n        rcvr: this.empStore.loginInfo.emp_no,\n        rcv_mthd: this.rcvrMth\n      }));\n\n      try {\n        await axios.post('/api/addMatImports', payloads);\n        alert('자재입고완료');\n        // 입고 후 목록에서 제거\n        this.purToLotStatus = this.purToLotStatus.filter(item => !this.checkPur.includes(item));\n        this.checkPur = [];\n      } catch (err) {\n        alert('자재입고실패');\n      }\n    },\n    isSelected(item) {\n      return this.checkPur.some(p => p.pur_ord_no === item.pur_ord_no);\n    },\n    toggleRow(item) {\n      const idx = this.checkPur.findIndex(p => p.pur_ord_no === item.pur_ord_no);\n      if (idx > -1) {\n        this.checkPur.splice(idx, 1);\n      } else {\n        this.checkPur.push(item);\n      }\n      if (this.checkPur.length === 1) {\n        const first = this.checkPur[0];\n        this.purOrdNo = first.pur_ord_no;\n        this.expDt = first['유통기한'];\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.table-primary {\n  background-color: #cce5ff;\n}\n</style>\n"],"names":["_sfc_main","useEmpStore","result","axios","payloads","order","p","item","idx","first","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_openBlock","_createElementBlock","_createElementVNode","$options","args","_cache","$event","$data","_Fragment","_renderList","_normalizeClass","_toDisplayString"],"mappings":"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"}