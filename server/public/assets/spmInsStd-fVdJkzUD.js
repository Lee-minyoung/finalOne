import{_ as k,c as d,a as t,w as i,v as a,F as c,r as S,g as w,o,t as m,i as L,j as f,b as _,l as M,e as b,m as g}from"./index-BjdZvEQ0.js";import{u as v}from"./useDates-UMs5Kxim.js";const V={props:{prodList:{type:Array,default:()=>[]}},data(){return{search:""}},computed:{filteredProducts(){return this.prodList?this.prodList.filter(l=>{var s;return(s=l.prd_nm)==null?void 0:s.includes(this.search)}):[]}},methods:{selectProduct(l){this.$emit("select-product",l),this.$emit("close")}}},U={class:"modal-dialog modal-lg"},P={class:"modal-content"},C={class:"modal-header"},D={class:"modal-body"},q={class:"d-flex justify-content-between align-items-center mb-2"},R={class:"table table-sm table-bordered text-center"},N=["onClick"];function Q(l,s,h,I,n,u){return o(),d("div",{class:"modal fade show d-block",style:{background:"rgba(0,0,0,0.5)","z-index":"1051"},onClick:s[2]||(s[2]=w(p=>l.$emit("close"),["self"]))},[t("div",U,[t("div",P,[t("div",C,[s[3]||(s[3]=t("h5",{class:"modal-title"},"제품 선택",-1)),t("button",{type:"button",class:"btn-close",onClick:s[0]||(s[0]=p=>l.$emit("close"))})]),t("div",D,[t("div",q,[i(t("input",{type:"text",class:"form-control w-25",placeholder:"제품명 검색","onUpdate:modelValue":s[1]||(s[1]=p=>n.search=p)},null,512),[[a,n.search]])]),t("table",R,[s[4]||(s[4]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"제품ID"),t("th",null,"제품명")])],-1)),t("tbody",null,[(o(!0),d(c,null,S(u.filteredProducts,p=>(o(),d("tr",{key:p.prd_no,onClick:e=>u.selectProduct(p),style:{cursor:"pointer"}},[t("td",null,m(p.prd_no),1),t("td",null,m(p.prd_nm),1)],8,N))),128))])])])])])])}const j=k(V,[["render",Q],["__scopeId","data-v-50d95d01"]]);g(!1);const B={components:{PrdSelModal:j},data(){return{searchQuery:"",selectedProductName:"",spmInsStdList:[],prodList:[],showProductModal:!1,newItem:{ins_itm:"",ins_mthd:"",ins_spc:"",ins_eqp:"",rmk:"",crt_by:"",mdf_dt:""}}},methods:{async spmInsStdInsert(){if(!this.searchQuery){alert("제품을 먼저 선택하세요.");return}let l={...this.newItem,prd_no:this.searchQuery,crt_by:this.selectedCrtBy,rgt_dt:new Date,mdf_dt:new Date};try{let h=(await b.post("/api/spmInsStd",l)).data;h.isSuccessed?(alert("등록되었습니다."),this.spmInsStdList.push({...l,spm_ins_std_no:h.prdNo}),this.newItem={ins_itm:"",ins_mthd:"",ins_spc:"",ins_eqp:"",rmk:"",crt_by:"",mdf_dt:""}):alert("모든 필드를 확인하세요.")}catch{alert("등록 중 오류가 발생했습니다.")}},dateFormat(l,s){return v.dateFormat(l,s)},enableEditMode(l){this.spmInsStdList[l].originalData={...this.spmInsStdList[l]},this.spmInsStdList[l].editMode=!0},disableEditMode(l){this.spmInsStdList[l].originalData?(this.spmInsStdList[l]={...this.spmInsStdList[l].originalData,editMode:!1},delete this.spmInsStdList[l].originalData):this.spmInsStdList[l].editMode=!1},async saveRow(l){let s={ins_itm:this.spmInsStdList[l].ins_itm||"",ins_mthd:this.spmInsStdList[l].ins_mthd||"",ins_spc:this.spmInsStdList[l].ins_spc||"",ins_eqp:this.spmInsStdList[l].ins_eqp||"",rmk:this.spmInsStdList[l].rmk||"",spm_ins_std_no:this.spmInsStdList[l].spm_ins_std_no||""};if(!this.spmInsStdList[l].spm_ins_std_no){alert("spm_ins_std_no 값이 없습니다. 데이터를 확인하세요.");return}try{(await b.put(`/api/spmInsStd/${this.spmInsStdList[l].spm_ins_std_no}`,s)).data.isUpdated?(alert("수정되었습니다."),this.spmInsStdList[l].editMode=!1,delete this.spmInsStdList[l].originalData):alert(`수정되지 않았습니다.
데이터를 확인해보세요.`)}catch{alert("수정 중 오류가 발생했습니다.")}},async deleteRow(l){if(confirm("정말 삭제하시겠습니까?"))try{(await b.delete(`/api/spmInsStd/${this.spmInsStdList[l].spm_ins_std_no}`)).data.isDeleted?(alert("삭제되었습니다."),this.spmInsStdList.splice(l,1)):alert(`삭제되지 않았습니다.
데이터를 확인해보세요.`)}catch{alert("삭제 중 오류가 발생했습니다.")}},showModal(){this.showProductModal=!0},hideModal(){this.showProductModal=!1},openProductModal(){b.get("/api/spmInsStd/prdList").then(l=>{this.prodList=Array.isArray(l.data)?l.data:[],this.showProductModal=!0}).catch(l=>{console.error("제품 목록 불러오기 실패",l),this.prodList=[]})},handleSelectedProduct(l){this.searchQuery=l.prd_no,this.selectedProductName=l.prd_nm,this.showProductModal=!1,this.getSpmInsStdList(l.prd_no)},async getSpmInsStdList(l){try{const s=await b.get("/api/spmInsStd",{params:{prd_no:l}});this.spmInsStdList=s.data}catch{alert("기준서 목록을 가져오는 중 오류가 발생했습니다.")}}}},E={class:"container mt-4"},F={class:"input"},A=["value"],T={class:"table table-bordered text-center"},z=["onUpdate:modelValue"],O=["onUpdate:modelValue"],G=["onUpdate:modelValue"],H=["onUpdate:modelValue"],J=["onUpdate:modelValue"],K=["onUpdate:modelValue"],W=["onUpdate:modelValue"],X=["onClick"],Y=["onClick"],Z=["onClick"],$=["onClick"];function x(l,s,h,I,n,u){const p=M("PrdSelModal");return o(),d(c,null,[t("div",E,[s[15]||(s[15]=t("div",{class:"d-flex justify-content-between align-items-center mb-4"},[t("div",{class:"d-flex gap-4"},[t("h2",{class:"mb-4"},"완제품검사기준서")])],-1)),t("div",F,[s[11]||(s[11]=_(" 제품번호 ")),i(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.searchQuery=e),class:"form-control",id:"input_id",placeholder:"",readonly:""},null,512),[[a,n.searchQuery]]),t("button",{class:"btn btn-outline-secondary",id:"icon-btn",onClick:s[1]||(s[1]=(...e)=>u.openProductModal&&u.openProductModal(...e))},"🔍"),s[12]||(s[12]=_(" 제품명 ")),t("input",{value:n.selectedProductName,class:"form-control",id:"input",readonly:"",style:{"background-color":"#eee"}},null,8,A)]),s[16]||(s[16]=t("br",null,null,-1)),t("table",T,[s[14]||(s[14]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"NO"),t("th",null,"검사항목"),t("th",null,"검사기준"),t("th",null,"규격"),t("th",null,"사용장비"),t("th",null,"작성자"),t("th",null,"수정일자"),t("th",null,"비고"),t("th",null,"수정")])],-1)),t("tbody",null,[t("tr",null,[s[13]||(s[13]=t("td",null,null,-1)),t("td",null,[i(t("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>n.newItem.ins_itm=e),class:"form-control",placeholder:"검사항목"},null,512),[[a,n.newItem.ins_itm]])]),t("td",null,[i(t("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>n.newItem.ins_mthd=e),class:"form-control",placeholder:"검사기준"},null,512),[[a,n.newItem.ins_mthd]])]),t("td",null,[i(t("input",{"onUpdate:modelValue":s[4]||(s[4]=e=>n.newItem.ins_spc=e),class:"form-control",placeholder:"규격"},null,512),[[a,n.newItem.ins_spc]])]),t("td",null,[i(t("input",{"onUpdate:modelValue":s[5]||(s[5]=e=>n.newItem.ins_eqp=e),class:"form-control",placeholder:"사용장비"},null,512),[[a,n.newItem.ins_eqp]])]),t("td",null,[i(t("input",{"onUpdate:modelValue":s[6]||(s[6]=e=>n.newItem.crt_by=e),class:"form-control",placeholder:"작성자",readonly:"",style:{"background-color":"#eee"}},null,512),[[a,n.newItem.crt_by]])]),t("td",null,[i(t("input",{"onUpdate:modelValue":s[7]||(s[7]=e=>n.newItem.mdf_dt=e),class:"form-control",placeholder:"수정일자",readonly:"",style:{"background-color":"#eee"}},null,512),[[a,n.newItem.mdf_dt]])]),t("td",null,[i(t("input",{"onUpdate:modelValue":s[8]||(s[8]=e=>n.newItem.rmk=e),class:"form-control",placeholder:"비고"},null,512),[[a,n.newItem.rmk]])]),t("td",null,[t("button",{onClick:s[9]||(s[9]=(...e)=>u.spmInsStdInsert&&u.spmInsStdInsert(...e)),class:"btn btn-primary btn-sm"},"추가")])]),(o(!0),d(c,null,S(n.spmInsStdList,(e,y)=>(o(),d("tr",{key:e.spm_ins_std_no},[t("td",null,m(y+1),1),t("td",null,[e.editMode?i((o(),d("input",{key:0,"onUpdate:modelValue":r=>e.ins_itm=r,class:"form-control"},null,8,z)),[[a,e.ins_itm]]):(o(),d(c,{key:1},[_(m(e.ins_itm),1)],64))]),t("td",null,[e.editMode?i((o(),d("input",{key:0,"onUpdate:modelValue":r=>e.ins_mthd=r,class:"form-control"},null,8,O)),[[a,e.ins_mthd]]):(o(),d(c,{key:1},[_(m(e.ins_mthd),1)],64))]),t("td",null,[e.editMode?i((o(),d("input",{key:0,"onUpdate:modelValue":r=>e.ins_spc=r,class:"form-control"},null,8,G)),[[a,e.ins_spc]]):(o(),d(c,{key:1},[_(m(e.ins_spc),1)],64))]),t("td",null,[e.editMode?i((o(),d("input",{key:0,"onUpdate:modelValue":r=>e.ins_eqp=r,class:"form-control"},null,8,H)),[[a,e.ins_eqp]]):(o(),d(c,{key:1},[_(m(e.ins_eqp),1)],64))]),t("td",null,[e.editMode?i((o(),d("input",{key:0,"onUpdate:modelValue":r=>e.crt_by=r,class:"form-control",readonly:"",style:{"background-color":"#eee"}},null,8,J)),[[a,e.crt_by]]):(o(),d(c,{key:1},[_(m(e.crt_by),1)],64))]),t("td",null,[e.editMode?i((o(),d("input",{key:0,"onUpdate:modelValue":r=>e.mdf_dt=r,class:"form-control",readonly:"",style:{"background-color":"#eee"}},null,8,K)),[[a,e.mdf_dt]]):(o(),d(c,{key:1},[_(m(u.dateFormat(e.mdf_dt,"yyyy-MM-dd")),1)],64))]),t("td",null,[e.editMode?i((o(),d("input",{key:0,"onUpdate:modelValue":r=>e.rmk=r,class:"form-control"},null,8,W)),[[a,e.rmk]]):(o(),d(c,{key:1},[_(m(e.rmk),1)],64))]),t("td",null,[e.editMode?f("",!0):(o(),d("button",{key:0,onClick:r=>u.enableEditMode(y),class:"btn btn-warning btn-sm"},"수정",8,X)),e.editMode?(o(),d("button",{key:1,onClick:r=>u.saveRow(y),class:"btn btn-success btn-sm"},"저장",8,Y)):f("",!0),e.editMode?(o(),d("button",{key:2,onClick:r=>u.disableEditMode(y),class:"btn btn-secondary btn-sm"},"취소",8,Z)):f("",!0),t("button",{onClick:r=>u.deleteRow(y),class:"btn btn-danger btn-sm"},"삭제",8,$)])]))),128))])])]),n.showProductModal?(o(),L(p,{key:0,prodList:n.prodList,onSelectProduct:u.handleSelectedProduct,onClose:s[10]||(s[10]=e=>n.showProductModal=!1)},null,8,["prodList","onSelectProduct"])):f("",!0)],64)}const et=k(B,[["render",x]]);export{et as default};
//# sourceMappingURL=spmInsStd-fVdJkzUD.js.map
