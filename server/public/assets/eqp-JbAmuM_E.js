import{d as _}from"./useCommonCode-DKmraWxZ.js";import{_ as I,e as m,c as q,a as t,i as b,j as v,w as i,v as u,k as E,d as y,l as h,o as r,F as w,r as L,f as S,t as c}from"./index-DRp0-N0C.js";import{e as g}from"./empSelectModal-DIkxnxAD.js";const F={components:{empSelectModal:g},props:{eqp:Object},data(){return{useLine:"",eqpInfo:{},empList:[],showEmpModal:!1,selectedEmp:null}},watch:{eqp(){let o=this.eqp;this.getEqpInfo(o.eqp_no)}},watch:{eqp:{handler(o){o?this.getEqpInfo(o.eqp_no):this.eqpInfo={}},immediate:!0}},methods:{eqpStatusFormat(o){return _.eqpStatusFormat(o)},async getEqpInfo(o){let e=await m.get(`/api/eqp/${o}`).catch(a=>console.log(a));this.eqpInfo=e.data,this.eqpInfo.ln_no===null?this.useLine="등록된 라인이 없습니다.":this.useLine="라인번호 : "+this.eqpInfo.ln_no+" / 라인명 : "+this.eqpInfo.ln_nm},async eqpUpdate(){var d;if(!((d=this.eqpInfo.eqp_nm)!=null&&d.trim())){alert("설비명을 입력해주세요.");return}if(!this.eqpInfo.eqp_mgr){alert("설비관리자를 선택해주세요.");return}if(!this.eqpInfo.eqp_sts){alert("설비상태를 선택해주세요.");return}if(!this.eqpInfo.use_yn){alert("사용여부를 선택해주세요.");return}let o={eqp_nm:this.eqpInfo.eqp_nm.trim(),eqp_mgr:this.eqpInfo.eqp_mgr,eqp_sts:this.eqpInfo.eqp_sts,use_yn:this.eqpInfo.use_yn},e=await m.put(`/api/eqp/${this.eqpInfo.eqp_no}`,o).catch(l=>console.log(l));console.log(e),e.data.isUpdated?(alert("수정되었습니다."),this.$emit("eqp-reload"),this.getEqpInfo(this.eqpInfo.eqp_no)):alert(`수정되지 않았습니다.
데이터를 확인해보세요.`)},saveEqp(){confirm(`정말로 수정하시겠습니까?
변경된 내용은 즉시 적용됩니다.`)&&this.eqpUpdate()},addEqp(){this.$emit("goToForm",!1)},async deleteEqp(o){o>0?confirm(`정말로 삭제하시겠습니까?
삭제된 데이터는 복구할 수 없습니다.`)&&((await m.delete(`/api/eqp/${o}`).catch(l=>console.log(l))).data.affectedRows>0?(alert("정상적으로 삭제되었습니다."),this.$emit("eqp-reload"),this.eqpInfo={},this.$emit("clear-selection")):alert("삭제되지 않았습니다.")):alert("삭제할 사원을 선택하세요")},resetForm(){this.getEqpInfo(this.eqpInfo.eqp_no)},openEmpModal(){m.get("/api/emp").then(o=>{this.empList=o.data,this.showEmpModal=!0}).catch(o=>{console.error("사원 목록 불러오기 실패",o)})},handleSelectedEmp(o){this.eqpInfo.eqp_mgr=o.emp_no,this.eqpInfo.nm=o.nm,this.showEmpModal=!1}}},k={class:"col-md-6"},x={class:"d-flex justify-content-between mb-3"},C={class:"card p-3"},M={key:0},V={class:"input-group"},U={key:1};function R(o,e,a,d,l,n){const f=h("empSelectModal");return r(),q("div",k,[t("div",x,[t("div",null,[t("button",{class:"btn btn-primary me-2",onClick:e[0]||(e[0]=(...s)=>n.addEqp&&n.addEqp(...s))},"등록"),t("button",{class:"btn btn-danger",onClick:e[1]||(e[1]=s=>n.deleteEqp(l.eqpInfo.eqp_no))},"삭제")]),t("div",null,[t("button",{class:"btn btn-warning me-2",onClick:e[2]||(e[2]=(...s)=>n.resetForm&&n.resetForm(...s))},"초기화"),t("button",{class:"btn btn-success",onClick:e[3]||(e[3]=(...s)=>n.saveEqp&&n.saveEqp(...s))},"저장")])]),t("div",C,[e[21]||(e[21]=t("h4",null,"상세 보기",-1)),a.eqp?(r(),q("div",M,[t("div",null,[e[14]||(e[14]=t("label",{class:"form-label"},"설비번호",-1)),i(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[4]||(e[4]=s=>l.eqpInfo.eqp_no=s),readonly:"",disabled:""},null,512),[[u,l.eqpInfo.eqp_no]]),e[15]||(e[15]=t("label",{class:"form-label"},"설비명",-1)),i(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=s=>l.eqpInfo.eqp_nm=s)},null,512),[[u,l.eqpInfo.eqp_nm]]),e[16]||(e[16]=t("label",{class:"form-label"},"설비관리자",-1)),t("div",V,[i(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>l.eqpInfo.nm=s),type:"text",class:"form-control",readonly:""},null,512),[[u,l.eqpInfo.nm]]),t("button",{class:"btn btn-outline-secondary",onClick:e[7]||(e[7]=s=>n.openEmpModal())},"사원 선택")]),e[17]||(e[17]=t("label",{class:"form-label"},"설비상태",-1)),i(t("select",{class:"form-select form-control","onUpdate:modelValue":e[8]||(e[8]=s=>l.eqpInfo.eqp_sts=s)},e[12]||(e[12]=[y('<option value="h1" data-v-13c3515d>정상</option><option value="h2" data-v-13c3515d>수리중</option><option value="h3" data-v-13c3515d>점검중</option><option value="h4" data-v-13c3515d>대기</option><option value="h5" data-v-13c3515d>공정중</option><option value="h6" data-v-13c3515d>완료</option>',6)]),512),[[E,l.eqpInfo.eqp_sts]]),e[18]||(e[18]=t("label",{class:"form-label"},"등록된라인",-1)),i(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[9]||(e[9]=s=>l.useLine=s),readonly:"",disabled:""},null,512),[[u,l.useLine]]),e[19]||(e[19]=t("label",{class:"form-label"},"사용여부",-1)),i(t("select",{class:"form-select form-control","onUpdate:modelValue":e[10]||(e[10]=s=>l.eqpInfo.use_yn=s)},e[13]||(e[13]=[t("option",{value:"f1"},"여",-1),t("option",{value:"f2"},"부",-1)]),512),[[E,l.eqpInfo.use_yn]])])])):(r(),q("div",U,e[20]||(e[20]=[t("p",null,"설비를 선택하세요!",-1)])))]),l.showEmpModal?(r(),b(f,{key:0,empList:l.empList,selected:l.eqpInfo.eqp_mgr,onSelectEmp:n.handleSelectedEmp,onClose:e[11]||(e[11]=s=>l.showEmpModal=!1)},null,8,["empList","selected","onSelectEmp"])):v("",!0)])}const T=I(F,[["render",R],["__scopeId","data-v-13c3515d"]]),j={components:{empSelectModal:g},data(){return{eqp_no:null,eqp_nm:"",eqp_mgr:null,nm:"",empList:[],showEmpModal:!1,selectedEmp:null}},created(){this.getEqpNo()},methods:{async getEqpNo(){let o=await m.get("/api/eqpNo").catch(e=>console.log(e));this.eqp_no=o.data[0].addEqpNo},resetForm(){this.eqp_nm="",this.eqp_mgr=null,this.nm=""},async eqpInsert(){var d;if(!((d=this.eqp_nm)!=null&&d.trim())){alert("설비명을 입력해주세요.");return}if(!this.eqp_mgr){alert("설비관리자를 선택해주세요.");return}let o={eqp_no:this.eqp_no,eqp_nm:this.eqp_nm.trim(),eqp_mgr:this.eqp_mgr};(await m.post("/api/eqp",o).catch(l=>console.log(l))).data.isSuccessed?(alert("등록되었습니다."),this.$emit("eqp-reload")):alert(`등록되지 않았습니다.
데이터를 확인해보세요.`),this.$emit("goToInfo",!0)},openEmpModal(){m.get("/api/emp").then(o=>{this.empList=o.data,this.showEmpModal=!0}).catch(o=>{console.error("사원 목록 불러오기 실패",o)})},handleSelectedEmp(o){this.eqp_mgr=o.emp_no,this.nm=o.nm,this.showEmpModal=!1}}},N={class:"col-md-6"},B={class:"d-flex justify-content-between mb-3"},G={class:"card p-3"},Q={class:"input-group"};function D(o,e,a,d,l,n){const f=h("empSelectModal");return r(),q("div",N,[t("div",B,[e[7]||(e[7]=t("div",null,null,-1)),t("div",null,[t("button",{class:"btn btn-warning me-2",onClick:e[0]||(e[0]=(...s)=>n.resetForm&&n.resetForm(...s))},"초기화"),t("button",{class:"btn btn-success",onClick:e[1]||(e[1]=(...s)=>n.eqpInsert&&n.eqpInsert(...s))},"저장")])]),t("div",G,[e[15]||(e[15]=t("h4",null,"설비 등록",-1)),t("div",null,[t("div",null,[e[8]||(e[8]=t("label",{class:"form-label"},"설비번호",-1)),i(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=s=>l.eqp_no=s),readonly:"",disabled:""},null,512),[[u,l.eqp_no]]),e[9]||(e[9]=t("label",{class:"form-label"},"설비명",-1)),i(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=s=>l.eqp_nm=s)},null,512),[[u,l.eqp_nm]]),e[10]||(e[10]=t("label",{class:"form-label"},"설비관리자",-1)),t("div",Q,[i(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>l.nm=s),type:"text",class:"form-control",readonly:""},null,512),[[u,l.nm]]),t("button",{class:"btn btn-outline-secondary",onClick:e[5]||(e[5]=s=>n.openEmpModal())},"사원 선택")]),e[11]||(e[11]=t("label",{class:"form-label"},"설비상태",-1)),e[12]||(e[12]=t("input",{type:"text",class:"form-control",value:"정상",readonly:"",disabled:""},null,-1)),e[13]||(e[13]=t("label",{class:"form-label"},"사용여부",-1)),e[14]||(e[14]=t("input",{type:"text",class:"form-control",value:"여",readonly:"",disabled:""},null,-1))])])]),l.showEmpModal?(r(),b(f,{key:0,empList:l.empList,selected:l.eqp_mgr,onSelectEmp:n.handleSelectedEmp,onClose:e[6]||(e[6]=s=>l.showEmpModal=!1)},null,8,["empList","selected","onSelectEmp"])):v("",!0)])}const z=I(j,[["render",D],["__scopeId","data-v-bc96e1ea"]]),O={components:{eqpInfo:T,eqpForm:z},data(){return{searchQuery:"",selectedFilter:"",selectedEqp:null,eqpList:[],InfoView:!0}},computed:{filteredEqpList(){return this.eqpList.filter(o=>o.eqp_nm.toLowerCase().includes(this.searchQuery.toLowerCase())&&(this.selectedFilter===""||o.eqp_sts===this.selectedFilter))}},created(){this.getEqpList()},methods:{eqpStatusFormat(o){return _.eqpStatusFormat(o)},async getEqpList(){let o=await m.get("/api/eqpList").catch(e=>console.log(e));this.eqpList=o.data},async selectEqp(o){try{const e=this.eqpList.find(a=>a.eqp_no===o);this.InfoView=!0,await this.$nextTick(),this.selectedEqp=e}catch(e){console.error("설비 선택 중 오류 발생:",e)}},msg(o){this.InfoView=o,o||(this.selectedEqp=null)},clearSelection(){this.selectedEqp=null}}},A={class:"container mt-4"},H={class:"row"},J={class:"col-md-6"},K={class:"d-flex justify-content-between mb-3"},P={class:"card p-3"},W={class:"table-container"},X={class:"table table-bordered"},Y=["onClick"],Z={class:"w-10"},$={class:"w-30"},ee={class:"w-10"},te={class:"w-10"};function oe(o,e,a,d,l,n){const f=h("eqpInfo"),s=h("eqpForm");return r(),q("div",A,[t("div",H,[e[5]||(e[5]=t("h1",null,"설비관리",-1)),t("div",J,[t("div",K,[i(t("input",{type:"text",class:"form-control w-50",placeholder:"설비명 검색...","onUpdate:modelValue":e[0]||(e[0]=p=>l.searchQuery=p)},null,512),[[u,l.searchQuery]]),i(t("select",{class:"form-select w-25","onUpdate:modelValue":e[1]||(e[1]=p=>l.selectedFilter=p)},e[2]||(e[2]=[y('<option value="" data-v-acbb3f21>전체</option><option value="h1" data-v-acbb3f21>정상</option><option value="h2" data-v-acbb3f21>수리중</option><option value="h3" data-v-acbb3f21>점검중</option><option value="h4" data-v-acbb3f21>대기</option><option value="h5" data-v-acbb3f21>공정중</option><option value="h6" data-v-acbb3f21>완료</option>',7)]),512),[[E,l.selectedFilter]])]),t("div",P,[e[4]||(e[4]=t("h4",null,"설비 목록",-1)),t("div",W,[t("table",X,[e[3]||(e[3]=t("thead",null,[t("tr",null,[t("th",{class:"w-10"},"설비번호"),t("th",{class:"w-30"},"설비명"),t("th",{class:"w-10"},"관리자"),t("th",{class:"w-10"},"설비상태")])],-1)),t("tbody",null,[(r(!0),q(w,null,L(n.filteredEqpList,p=>(r(),q("tr",{key:p.eqp_no,onClick:le=>n.selectEqp(p.eqp_no),class:S([{"table-primary":l.selectedEqp&&l.selectedEqp.eqp_no===p.eqp_no},"table-hover"])},[t("td",Z,c(p.eqp_no),1),t("td",$,c(p.eqp_nm),1),t("td",ee,c(p.nm),1),t("td",te,c(n.eqpStatusFormat(p.eqp_sts)),1)],10,Y))),128))])])])])]),l.InfoView?(r(),b(f,{key:0,eqp:l.selectedEqp,onGoToForm:n.msg,onEqpReload:n.getEqpList,onClearSelection:n.clearSelection},null,8,["eqp","onGoToForm","onEqpReload","onClearSelection"])):v("",!0),l.InfoView?v("",!0):(r(),b(s,{key:1,onGoToInfo:n.msg,onEqpReload:n.getEqpList},null,8,["onGoToInfo","onEqpReload"]))])])}const ie=I(O,[["render",oe],["__scopeId","data-v-acbb3f21"]]);export{ie as default};
//# sourceMappingURL=eqp-JbAmuM_E.js.map
